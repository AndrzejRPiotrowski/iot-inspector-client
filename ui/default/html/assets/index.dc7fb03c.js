import{G as y,j as c,a as e,g,r as n,u as x,R as N,H as b,c as _,b as w,d as D,F as h}from"./main.017d8407.js";import{d as f}from"./utils.7514bafb.js";import"./useNetworkDownloadActivity.4a2b567a.js";function v(s){return y({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 20h2V8h3L8 4 4 8h3zm13-4h-3V4h-2v12h-3l4 4z"}}]})(s)}const S=({device:s})=>c("div",{className:"device-item status-empty",children:[c("div",{className:"device-info",children:[e("img",{src:"https://via.placeholder.com/150",alt:s?s.auto_name:"Unknown Device",className:"hidden w-auto h-12 lg:block md:h-16"}),c("div",{className:"px-4",children:[e("h3",{children:s?s.auto_name:"Unknown Device"}),c("p",{className:"text-xs",children:[s&&s.ip,e("br",{}),s&&s.mac]})]})]}),e("div",{className:"device-tags",children:e("div",{className:"tag",children:"tag"})}),c("div",{className:"device-details",children:[s&&e("div",{className:"flex items-center justify-center px-4 text-sm border-r border-gray-300 w-fit",children:f(s.outbound_byte_count)}),e("div",{className:"flex items-center justify-center px-4 text-sm w-fit",children:e("a",{href:`/device-activity?deviceid=${s.device_id}`,className:"",children:"Details"})})]})]}),k=g`
  query Query {
    devices {
      device_id
      auto_name
      ip
      mac
      outbound_byte_count
    }
  }
`,C=()=>{const[s,i]=n.exports.useState([]),[a,t]=n.exports.useState({}),{data:r,loading:d}=x(k,{pollInterval:5e3});return n.exports.useEffect(()=>{if(r!=null&&r.devices){let l=r.devices;a!=null&&a.sort&&console.log("TODO: SORT"),i(l)}},[r==null?void 0:r.devices,a]),{devicesData:s,devicesDataLoading:d,sortDevicesData:(l,u="ASC")=>{t({sort:{by:l,direction:u}})}}},U=()=>{const{devicesData:s,devicesDataLoading:i,sortDevicesData:a}=C(),[t,r]=n.exports.useState(""),[d,m]=n.exports.useState("ASC"),[l,u]=n.exports.useState(!1);return c("section",{className:"bg-gray-50 flex-flex-col-gap-4",id:"inspecting-devices",children:[c("div",{className:"flex items-center w-full gap-4 md:gap-5",children:[c("div",{className:"",children:[e("h2",{className:"h1",children:"Inspecting Devices"}),e("p",{className:"py-2",children:"Naming & tagging helps with our research"})]}),e("div",{className:"w-8 h-8 md:w-10 md:h-10 animate-spin-slow",children:e(N,{})})]}),c("div",{className:"grid grid-cols-4 gap-4 py-4 md:flex md:items-center",children:[c("form",{className:"flex flex-1 order-last col-span-4 md:order-first",children:[e("input",{type:"text",name:"search",id:"searchDevices",value:t,onChange:o=>r(o.target.value),className:"w-full px-4 py-2 text-gray-600 bg-white border border-gray-400 rounded-md",placeholder:"Search devices by name or tag"}),c("label",{htmlFor:"searchDevices",className:"sr-only",children:[e(b,{}),"Search devices by name or tag"]})]}),c("button",{className:"flex items-center justify-center gap-1 p-2 text-sm",children:["Name",e(v,{className:"w-4 h-4 text-gray-400"})]}),c("button",{className:"flex items-center justify-center gap-1 p-2 text-sm",onClick:()=>{m(d==="ASC"?"DESC":"ASC"),a("outbound_byte_count",d)},children:["Traffic",e(v,{className:"w-4 h-4 text-gray-400"})]}),e("div",{className:"flex items-center justify-center gap-3 px-2",children:e(_,{checked:l,onChange:u,children:c("span",{className:"flex",children:[e(w,{className:`${l?"text-white rounded-lg bg-secondary":"text-dark"} w-10 h-10 md:w-8 md:h-8 p-1 `}),e(D,{className:`${l?"text-dark":"text-white rounded-lg bg-secondary"} w-10 h-10 md:w-8 md:h-8 p-1 `})]})})})]}),i?e(h,{children:"loading..."}):e("ul",{className:l?"card-grid":"min-h-[200px]",children:s==null?void 0:s.filter(o=>{if(!t||o.auto_name.toLowerCase().includes(t.toLowerCase()))return!0}).map(o=>e("li",{className:`${l?"card-view":"list-view"} py-2`,children:e(S,{device:o})},o.device_id))})]})},p=({children:s,bytes:i})=>c("div",{className:"flex-1 px-4 py-3 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e("div",{className:"block",children:e("span",{className:"h1",children:f(i)})}),s]}),E=g`
  query Query {
    devices {
      auto_name
      ip
      outbound_byte_count
    }
  }
`,I=()=>{const[s,i]=n.exports.useState([]),{data:a,loading:t}=x(E,{pollInterval:2e4});return n.exports.useEffect(()=>{if(a!=null&&a.devices){const r=a==null?void 0:a.devices.slice().sort((d,m)=>m.outbound_byte_count-d.outbound_byte_count);i(r)}},[a==null?void 0:a.devices]),{highUseageData:s,highUseageDataLoading:t}},V=g`
  query Query {
    networkActivity {
      weak_encryption
      unencrypted_http_traffic
      ads_and_trackers
    }
  }
`,H=()=>{const[s,i]=n.exports.useState([]),{data:a,loading:t}=x(V,{pollInterval:5e3});return n.exports.useEffect(()=>{a!=null&&a.networkActivity&&i(a.networkActivity)},[a==null?void 0:a.networkActivity]),{networkActivityData:s,networkActivityDataLoading:t}},L=()=>{const{highUseageData:s,highUseageDataLoading:i}=I(),{networkActivityDataLoading:a,networkActivityData:t}=H();return c(h,{children:[e("section",{className:"flex flex-col gap-4",children:e("h1",{children:"Network Activity"})}),e("section",{className:"flex flex-col gap-4 bg-gray-50",children:c("div",{className:"grid gap-6 py-8 lg:grid-cols-2 md:py-4",children:[c("div",{children:[c("p",{children:["High data usage devices in the past 24 hours",e("br",{}),e("a",{href:"#inspecting-devices",children:"View all devices"})]}),c("div",{className:"grid grid-cols-2 gap-2 py-4",children:[i&&e(h,{children:"loading..."}),s&&s.slice(0,3).map((r,d)=>c(p,{bytes:r.outbound_byte_count,children:[e("span",{className:"text-xs",children:r.auto_name}),e("br",{}),e("span",{className:"text-xs",children:r.ip})]},d))]})]}),a?e(h,{children:"loading..."}):c("div",{children:[c("p",{children:["Monitored devices sent/recieved",e("br",{}),e("strong",{children:f((t==null?void 0:t.ads_and_trackers)+(t==null?void 0:t.unencrypted_http_traffic)+(t==null?void 0:t.weak_encryption))})]}),c("div",{className:"grid grid-cols-2 gap-2 py-4",children:[e(p,{bytes:t==null?void 0:t.ads_and_trackers,children:e("span",{className:"text-xs",children:"Ads & Trackers"})}),e(p,{bytes:t==null?void 0:t.unencrypted_http_traffic,children:e("span",{className:"text-xs",children:"Unencrypted HTTP Traffic"})}),e(p,{bytes:t==null?void 0:t.weak_encryption,children:e("span",{className:"text-xs",children:"Weak Encryption"})})]})]})]})})]})},Q=()=>c(h,{children:[e(L,{}),e(U,{})]});export{Q as default};
