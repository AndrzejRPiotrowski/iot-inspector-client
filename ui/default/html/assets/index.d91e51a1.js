import{G as N,j as c,a as e,r as l,R as v,H as b,c as _,b as w,d as k,g,u as x,F as u}from"./main.fd1ac048.js";import{d as y}from"./utils.7514bafb.js";import{u as A,_ as S}from"./array.159ec8ee.js";function f(s){return N({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M7 20h2V8h3L8 4 4 8h3zm13-4h-3V4h-2v12h-3l4 4z"}}]})(s)}const C=({device:s})=>{var a;return c("div",{className:"device-item status-empty",children:[c("div",{className:"device-info",children:[e("img",{src:"https://via.placeholder.com/150",alt:s?s.auto_name:"Unknown Device",className:"hidden w-auto h-12 lg:block md:h-16"}),c("div",{className:"px-4",children:[e("h3",{children:((a=s==null?void 0:s.device_info)==null?void 0:a.device_name)||(s==null?void 0:s.auto_name)||"Unknown Device"}),c("p",{className:"text-xs",children:[s&&s.ip,e("br",{}),s&&s.mac]})]})]}),e("div",{className:"device-tags",children:e("div",{className:"tag",children:"tag"})}),c("div",{className:"device-details",children:[s&&e("div",{className:"flex items-center justify-center px-4 text-sm border-r border-gray-300 w-fit",children:y(s.outbound_byte_count)}),e("div",{className:"flex items-center justify-center px-4 text-sm w-fit",children:e("a",{href:`/device-activity?deviceid=${s.device_id}`,className:"",children:"Details"})})]})]})},D=()=>{const{devicesData:s,devicesDataLoading:a,sortDevicesData:r}=A(),[t,n]=l.exports.useState(""),[i,h]=l.exports.useState("ASC"),[d,p]=l.exports.useState(!1);return c("section",{className:"bg-gray-50 flex-flex-col-gap-4",id:"inspecting-devices",children:[c("div",{className:"flex items-center w-full gap-4 md:gap-5",children:[c("div",{className:"",children:[e("h2",{className:"h1",children:"Inspecting Devices"}),e("p",{className:"py-2",children:"Naming & tagging helps with our research"})]}),e("div",{className:"w-8 h-8 md:w-10 md:h-10 animate-spin-slow",children:e(v,{})})]}),c("div",{className:"grid grid-cols-4 gap-4 py-4 md:flex md:items-center",children:[c("form",{className:"flex flex-1 order-last col-span-4 md:order-first",children:[e("input",{type:"text",name:"search",id:"searchDevices",value:t,onChange:o=>n(o.target.value),className:"w-full px-4 py-2 text-gray-600 bg-white border border-gray-400 rounded-md",placeholder:"Search devices by name or tag"}),c("label",{htmlFor:"searchDevices",className:"sr-only",children:[e(b,{}),"Search devices by name or tag"]})]}),c("button",{className:"flex items-center justify-center gap-1 p-2 text-sm",children:["Name",e(f,{className:"w-4 h-4 text-gray-400"})]}),c("button",{className:"flex items-center justify-center gap-1 p-2 text-sm",onClick:()=>{h(i==="ASC"?"DESC":"ASC"),r("outbound_byte_count",i)},children:["Traffic",e(f,{className:"w-4 h-4 text-gray-400"})]}),e("div",{className:"flex items-center justify-center gap-3 px-2",children:e(_,{checked:d,onChange:p,children:c("span",{className:"flex",children:[e(w,{className:`${d?"text-white rounded-lg bg-secondary":"text-dark"} w-10 h-10 md:w-8 md:h-8 p-1 `}),e(k,{className:`${d?"text-dark":"text-white rounded-lg bg-secondary"} w-10 h-10 md:w-8 md:h-8 p-1 `})]})})})]}),a?e("div",{className:"skeleton h-[600px]"}):e("ul",{className:d?"card-grid":"min-h-[200px]",children:s==null?void 0:s.filter(o=>{if(!t||o.auto_name.toLowerCase().includes(t.toLowerCase()))return!0}).map(o=>e("li",{className:`${d?"card-view":"list-view"} py-2`,children:e(C,{device:o})},o.device_id))})]})},m=({children:s,bytes:a})=>c("div",{className:"flex-1 px-4 py-3 bg-white border border-gray-200 rounded-lg shadow-sm",children:[e("div",{className:"block",children:e("span",{className:"h1",children:y(a)})}),s]}),I=g`
  query Query {
    chartActivity {
      xAxis
      yAxis {
        name
        data
      }
    }
  }
`,U=s=>{var n,i,h,d;s!=null&&s.pullInterval,(i=(n=s==null?void 0:s.filters)==null?void 0:n.sort)!=null&&i.by,(d=(h=s==null?void 0:s.filters)==null?void 0:h.sort)!=null&&d.ascending;const a={deviceId:(s==null?void 0:s.deviceId)||null},{data:r,loading:t}=x(I,{variables:a});return{networkDownloadActivity:r,networkDownloadActivityLoading:t}},H=({deviceId:s})=>{const{networkDownloadActivity:a,networkDownloadActivityLoading:r}=U(),t=l.exports.useMemo(()=>{var i;return{chart:{id:"bar",stacked:!0},xaxis:{categories:((i=a==null?void 0:a.chartActivity)==null?void 0:i.xAxis)||[],type:"string"},options:{plotOptions:{bar:{borderRadius:"10px"}}}}},[a]),n=l.exports.useMemo(()=>{var i;return((i=a==null?void 0:a.chartActivity)==null?void 0:i.yAxis.slice(0,3))||[]},[a]);return e("div",{className:"network-bar-chart",children:e("div",{className:"row",children:e("div",{className:"mixed-chart",children:e(S,{options:t,series:n,type:"bar",width:"100%",height:"300"})})})})},L=g`
  query Query {
    devices {
      auto_name
      ip
      outbound_byte_count
    }
  }
`,T=()=>{const[s,a]=l.exports.useState([]),{data:r,loading:t}=x(L);return l.exports.useEffect(()=>{if(r!=null&&r.devices){const n=r==null?void 0:r.devices.slice().sort((i,h)=>h.outbound_byte_count-i.outbound_byte_count);a(n)}},[r==null?void 0:r.devices]),{highUseageData:s,highUseageDataLoading:t}},V=g`
  query Query {
    networkActivity {
      weak_encryption
      unencrypted_http_traffic
      ads_and_trackers
    }
  }
`,E=()=>{const[s,a]=l.exports.useState([]),{data:r,loading:t}=x(V,{});return l.exports.useEffect(()=>{r!=null&&r.networkActivity&&a(r.networkActivity)},[r==null?void 0:r.networkActivity]),{networkActivityData:s,networkActivityDataLoading:t}},j=()=>{const{highUseageData:s,highUseageDataLoading:a}=T(),{networkActivityDataLoading:r,networkActivityData:t}=E();return c(u,{children:[a?e("div",{className:"h-full skeleton"}):c("section",{className:"flex flex-col gap-4",children:[e("h1",{children:"Network Activity"}),c("p",{children:["High data usage devices in the past 24 hours",e("br",{}),e("a",{href:"#inspecting-devices",children:"View all devices"})]}),e(H,{}),c("div",{className:"grid gap-2 py-4 md:grid-cols-2 lg:grid-cols-3",children:[a&&e(u,{children:e("div",{className:"skeleton h-[114px]"})}),s&&s.slice(0,3).map((n,i)=>c(m,{bytes:n.outbound_byte_count,children:[e("span",{className:"text-xs",children:n.auto_name}),e("br",{}),e("span",{className:"text-xs",children:n.ip})]},i))]}),e("hr",{}),e("div",{className:"grid gap-6 py-8 md:py-4",children:r?e("div",{className:"skeleton h-[114px]"}):c("div",{children:[c("p",{children:["All monitored devices sent/recieved \xA0",e("strong",{children:y((t==null?void 0:t.ads_and_trackers)+(t==null?void 0:t.unencrypted_http_traffic)+(t==null?void 0:t.weak_encryption))}),"\xA0 of data"]}),c("div",{className:"grid gap-2 py-4 md:grid-cols-2 lg:grid-cols-3",children:[e(m,{bytes:t==null?void 0:t.ads_and_trackers,children:e("span",{className:"text-xs",children:"Ads & Trackers"})}),e(m,{bytes:t==null?void 0:t.unencrypted_http_traffic,children:e("span",{className:"text-xs",children:"Unencrypted HTTP Traffic"})}),e(m,{bytes:t==null?void 0:t.weak_encryption,children:e("span",{className:"text-xs",children:"Weak Encryption"})})]})]})})]}),e("section",{className:"flex flex-col gap-4 bg-gray-50"})]})},Y=()=>c(u,{children:[e(j,{}),e(D,{})]});export{Y as default};
